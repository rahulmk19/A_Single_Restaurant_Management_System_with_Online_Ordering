<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoodTasteNow - Categories</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <!-- Navbar -->
    <nav class="bg-gradient-to-r from-red-500 to-pink-500 p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <a href="index.html" class="text-white font-extrabold text-3xl tracking-wide">FoodTasteNow</a>
            <div class="hidden md:flex space-x-4">
                <a href="index.html" class="text-white hover:text-gray-200">Home</a>
                <a href="category.html" class="text-white hover:text-gray-200">Category</a>
                <a href="User/login.html" class="text-white hover:text-gray-200">Sign In</a>
            </div>
        </div>
    </nav>

    <!-- Category Page Content -->
    <div class="container mx-auto mt-8 p-4">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Explore Categories</h1>
        
        <!-- Search and Filter Section -->
        <div class="flex flex-col md:flex-row justify-between mb-6 space-y-4 md:space-y-0">
            <!-- Search Bar -->
            <input type="text" id="searchBar" placeholder="Search products..." class="px-4 py-2 w-full md:w-1/3 rounded-lg border focus:outline-none focus:border-red-500">
            
            <!-- Sort Dropdown -->
            <select id="sortDropdown" class="px-4 py-2 rounded-lg border focus:outline-none">
                <option value="">Sort by</option>
                <option value="priceLowToHigh">Price: Low to High</option>
                <option value="priceHighToLow">Price: High to Low</option>
                <option value="popularity">Popularity</option>
            </select>
        </div>

        <!-- Filter Section -->
        <div class="mb-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Filter by Category</h2>
            <div class="flex space-x-4">
                <button class="category-filter px-4 py-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors" data-category="all">All</button>
                <button class="category-filter px-4 py-2 bg-gray-300 text-gray-800 rounded-full hover:bg-gray-400 transition-colors" data-category="Dessert">Dessert</button>
                <button class="category-filter px-4 py-2 bg-gray-300 text-gray-800 rounded-full hover:bg-gray-400 transition-colors" data-category="North Indian">North Indian</button>
                <button class="category-filter px-4 py-2 bg-gray-300 text-gray-800 rounded-full hover:bg-gray-400 transition-colors" data-category="South Indian">South Indian</button>
                <button class="category-filter px-4 py-2 bg-gray-300 text-gray-800 rounded-full hover:bg-gray-400 transition-colors" data-category="Cakes">Cakes</button>
            </div>
        </div>

        <!-- Products Grid -->
        <div id="productGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <!-- Products will be dynamically inserted here -->
        </div>
    </div>

    <script>
        async function fetchCategoryItems() {
            try {
                const response = await fetch("http://localhost:8081/foodtastenow/api/admin/items/getAll");
                if (response.ok) {
                    const items = await response.json();
                    displayCategoryItems(items);
                } else {
                    console.error("Failed to fetch category items");
                }
            } catch (error) {
                console.error("Error:", error);
            }
        }

        function displayCategoryItems(items) {
            const productGrid = document.getElementById("productGrid");
            productGrid.innerHTML = "";
            items.forEach((item) => {
                const productCard = document.createElement("div");
                productCard.className = "bg-white border rounded-lg p-4 shadow hover:shadow-lg transition-transform transform hover:scale-105";
                productCard.innerHTML = `
                    <img src="${item.imageUrl}" alt="${item.name}" class="w-full h-48 object-cover rounded-lg mb-4">
                    <h2 class="text-xl font-bold mb-2 text-gray-800">${item.name}</h2>
                    <p class="text-gray-600 mb-2">Category: ${item.category}</p>
                    <p class="text-red-500 text-lg font-semibold mb-4">₹${item.price.toFixed(2)}</p>
                    <button class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors">Add to Cart</button>
                `;
                productGrid.appendChild(productCard);
            });
        }

        // Event Listeners for Filters and Search
        document.addEventListener("DOMContentLoaded", () => {
            fetchCategoryItems();
            
            // Search functionality
            document.getElementById("searchBar").addEventListener("input", (event) => {
                const searchValue = event.target.value.toLowerCase();
                const products = document.querySelectorAll("#productGrid > div");
                products.forEach((product) => {
                    const productName = product.querySelector("h2").innerText.toLowerCase();
                    product.style.display = productName.includes(searchValue) ? "block" : "none";
                });
            });

            // Filter by Category
            const categoryFilters = document.querySelectorAll(".category-filter");
            categoryFilters.forEach((button) => {
                button.addEventListener("click", () => {
                    const selectedCategory = button.getAttribute("data-category");
                    categoryFilters.forEach((btn) => btn.classList.remove("bg-red-500", "text-white"));
                    button.classList.add("bg-red-500", "text-white");

                    const products = document.querySelectorAll("#productGrid > div");
                    products.forEach((product) => {
                        const productCategory = product.querySelector("p").innerText.split(": ")[1];
                        if (selectedCategory === "all" || productCategory === selectedCategory) {
                            product.style.display = "block";
                        } else {
                            product.style.display = "none";
                        }
                    });
                });
            });

            // Sort by Price or Popularity
            document.getElementById("sortDropdown").addEventListener("change", (event) => {
                const selectedSort = event.target.value;
                const productsArray = Array.from(document.querySelectorAll("#productGrid > div"));

                productsArray.sort((a, b) => {
                    const priceA = parseFloat(a.querySelector("p.text-red-500").innerText.replace("₹", ""));
                    const priceB = parseFloat(b.querySelector("p.text-red-500").innerText.replace("₹", ""));
                    if (selectedSort === "priceLowToHigh") return priceA - priceB;
                    if (selectedSort === "priceHighToLow") return priceB - priceA;
                    return 0;
                });

                const productGrid = document.getElementById("productGrid");
                productGrid.innerHTML = "";
                productsArray.forEach((product) => productGrid.appendChild(product));
            });
        });
    </script>
</body>
</html>
